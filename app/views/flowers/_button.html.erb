<% flowered = user_signed_in? && Flower.exists?(user: current_user, flowerable: flowerable) %>

<% url =
     if flowerable.is_a?(Comment)
       post_comment_flower_path(flowerable.post, flowerable)
     else
       post_flower_path(flowerable)
     end %>

<%= form_with url: url,
              method: flowered ? :delete : :post,
              data: { turbo_stream: true },
              class: "flower-form" do %>

  <button type="submit"
          class="flower-btn <%= flowered ? 'is-flowered' : 'is-unflowered' %>">
    <span class="flower-icon"><%= flowered ? "ðŸŒ¿" : "ðŸŒ±" %></span>
    <span class="flower-count"><%= flowerable.flowers.count %></span>
  </button>

<% end %>
