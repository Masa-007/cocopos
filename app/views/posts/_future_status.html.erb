<% return unless post.future? %>

<div class="px-8 pt-6 pb-8 border-t bg-gray-50">
  <!-- 進捗 -->
  <% if post.progress.present? %>
    <div class="mb-8">
      <div class="flex items-center justify-between text-sm mb-2">
        <span class="font-bold text-gray-700">🌱 進捗</span>
        <span class="text-gray-600"><%= post.progress %>%</span>
      </div>

      <div class="w-full bg-gray-200 rounded-full h-3">
        <div
          class="bg-green-400 h-3 rounded-full transition-all"
          style="width: <%= post.progress %>%;">
        </div>
      </div>
    </div>
  <% end %>

  <!-- 期限 -->
  <% if post.deadline.present? %>
    <% days_diff = (post.deadline - Date.current).to_i %>
        <% achieved = post.progress.to_i == 100 %>

    <div class="text-sm text-gray-700">
      <span class="font-bold">📅 期限：</span>
      <%= post.deadline.strftime("%Y年%m月%d日") %>
    </div>

    <% if achieved %>
      <div class="mt-5 p-4 bg-green-100 text-green-800 rounded-xl text-sm">
        🎉 <strong>達成済み</strong>
      </div>

    <% elsif days_diff > 0 && days_diff <= 7 %>
      <!-- 期限が近い -->
      <div class="mt-5 p-4 bg-yellow-100 text-yellow-800 rounded-xl text-sm">
        ⏰ 期限まであと <strong><%= days_diff %>日</strong>
      </div>

    <% elsif days_diff == 0 %>
      <!-- 今日が期限 -->
      <div class="mt-5 p-4 bg-orange-100 text-orange-800 rounded-xl text-sm">
        📌 <strong>本日が期限です</strong>
      </div>

    <% elsif days_diff < 0 %>
      <!-- 期限超過 -->
      <div class="mt-5 p-4 bg-red-100 text-red-800 rounded-xl text-sm">
        ⚠️ 期限から <strong><%= days_diff.abs %>日</strong> 経過しています
      </div>
    <% end %>
  <% end %>
</div>
