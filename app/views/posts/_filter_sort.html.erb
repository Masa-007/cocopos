<div class="mb-8">
  <% sub_filter_items = sub_filter_options(params[:filter]) %>

  <!-- üì± „Çπ„Éû„ÉõÔºöÁµû„ÇäËæº„Åø + ‰∏¶„Å≥Êõø„Åà + „Çµ„ÉñÁµû„ÇäËæº„ÅøÔºà„ÉØ„Ç§„Éâ„Å´„Åó„Å™„ÅÑÔºâ -->
  <div class="md:hidden grid grid-cols-2 gap-3">
    <!-- Áµû„ÇäËæº„Åø -->
    <%= form_with url: path.call, method: :get, local: true do |f| %>
      <%= f.hidden_field :sort, value: params[:sort] %>
      <%= f.hidden_field :sub_filter, value: params[:sub_filter] %>

      <div class="relative">
        <select name="filter"
                onchange="this.form.submit()"
                class="w-full appearance-none
                       rounded-xl border border-gray-300
                       bg-white px-4 py-3
                       text-gray-800 font-medium
                       shadow-sm
                       focus:border-orange-400 focus:ring-2 focus:ring-orange-200">
          <% filters.each do |item| %>
            <option value="<%= item[:value] %>" <%= "selected" if selected_filter?(params[:filter], item[:value]) %>>
              <%= item[:text] %>
            </option>
          <% end %>
        </select>

        <div class="pointer-events-none absolute inset-y-0 right-3 flex items-center text-gray-400">
          ‚ñº
        </div>
      </div>
    <% end %>

    <!-- ‰∏¶„Å≥Êõø„Åà -->
    <%= form_with url: path.call, method: :get, local: true do |f| %>
      <%= f.hidden_field :filter, value: params[:filter] %>
      <%= f.hidden_field :sub_filter, value: params[:sub_filter] %>

      <div class="relative">
        <select name="sort"
                onchange="this.form.submit()"
                class="w-full appearance-none
                       rounded-xl border border-gray-300
                       bg-white px-4 py-3
                       text-gray-800 font-medium
                       shadow-sm
                       focus:border-orange-400 focus:ring-2 focus:ring-orange-200">
          <option value="new" <%= "selected" if params[:sort] != "old" %>>Êñ∞„Åó„ÅÑÈ†Ü</option>
          <option value="old" <%= "selected" if params[:sort] == "old" %>>Âè§„ÅÑÈ†Ü</option>
        </select>

        <div class="pointer-events-none absolute inset-y-0 right-3 flex items-center text-gray-400">
          ‚ñº
        </div>
      </div>
    <% end %>

    <% if sub_filter_items.present? %>
      <!-- „Çµ„ÉñÁµû„ÇäËæº„ÅøÔºà„Çπ„Éû„Éõ„Åß„ÇÇ„ÉØ„Ç§„Éâ„Å´„Åó„Å™„ÅÑÔºöcol-span-2„Å´„Åó„Å™„ÅÑÔºâ -->
      <%= form_with url: path.call, method: :get, local: true do |f| %>
        <%= f.hidden_field :filter, value: params[:filter] %>
        <%= f.hidden_field :sort, value: params[:sort] %>

        <div class="relative">
          <select name="sub_filter"
                  onchange="this.form.submit()"
                  class="w-full appearance-none
                         rounded-xl border border-gray-300
                         bg-white px-4 py-3
                         text-gray-800 font-medium
                         shadow-sm
                         focus:border-orange-400 focus:ring-2 focus:ring-orange-200">
            <% sub_filter_items.each do |item| %>
              <option value="<%= item[:value] %>" <%= "selected" if params[:sub_filter].to_s == item[:value] %>>
                <%= item[:text] %>
              </option>
            <% end %>
          </select>

          <div class="pointer-events-none absolute inset-y-0 right-3 flex items-center text-gray-400">
            ‚ñº
          </div>
        </div>
      <% end %>
    <% end %>
  </div>

  <!-- üñ• PCÔºöÁÆ±„Éú„Çø„É≥Âàó„ÅÆÂè≥Á´Ø„Å´„ÄÅÂè≥ÂÅ¥„Å´„ÇΩ„Éº„Éà -->
  <div class="hidden md:flex items-start justify-between gap-4">
    <!-- Â∑¶ÔºöÁÆ±„Éú„Çø„É≥ + „Çµ„ÉñÁµû„ÇäËæº„Åø -->
    <div class="flex-1">
      <div class="flex items-center gap-2">
        <span class="font-semibold text-gray-700"><%= pc_label %></span>

        <!-- ÁÆ±„Éú„Çø„É≥Âàó + „Çµ„ÉñÁµû„ÇäËæº„ÅøÔºàÂêå„ÅòË°å„ÅßÂè≥Á´Ø„Å´ÂØÑ„Åõ„ÇãÔºâ -->
        <div class="flex items-center gap-2 flex-wrap flex-1">
          <% filters.each do |item| %>
            <%= link_to item[:text],
                        path.call(
                          filter: item[:value],
                          sort: params[:sort],
                          sub_filter: (item[:value].to_s == params[:filter].to_s ? params[:sub_filter] : nil)
                        ),
                        class: "filter-btn whitespace-nowrap #{'active' if selected_filter?(params[:filter], item[:value])}" %>
          <% end %>

          <% if sub_filter_items.present? %>
            <%= form_with url: path.call, method: :get, local: true do |f| %>
              <%= f.hidden_field :filter, value: params[:filter] %>
              <%= f.hidden_field :sort, value: params[:sort] %>

              <div class="ml-auto flex-shrink-0">
                <select name="sub_filter"
                        onchange="this.form.submit()"
                        class="rounded-xl border border-gray-300
                               bg-white px-4 py-2
                               text-gray-800
                               shadow-sm
                               focus:border-orange-400 focus:ring-2 focus:ring-orange-200">
                  <% sub_filter_items.each do |item| %>
                    <option value="<%= item[:value] %>" <%= "selected" if params[:sub_filter].to_s == item[:value] %>>
                      <%= item[:text] %>
                    </option>
                  <% end %>
                </select>
              </div>
            <% end %>
          <% else %>
            <%= hidden_field_tag :sub_filter, nil %>
          <% end %>
        </div>
      </div>
    </div>

    <!-- Âè≥Ôºö‰∏¶„Å≥Êõø„ÅàÔºàÂçòÁã¨Ôºâ -->
    <%= form_with url: path.call, method: :get, local: true do |f| %>
      <%= f.hidden_field :filter, value: params[:filter] %>
      <%= f.hidden_field :sub_filter, value: params[:sub_filter] %>

      <div class="relative">
        <select name="sort"
                onchange="this.form.submit()"
                class="rounded-xl border border-gray-300
                       bg-white px-4 py-2
                       text-gray-800
                       shadow-sm
                       focus:border-orange-400 focus:ring-2 focus:ring-orange-200">
          <option value="new" <%= "selected" if params[:sort] != "old" %>>Êñ∞„Åó„ÅÑÈ†Ü</option>
          <option value="old" <%= "selected" if params[:sort] == "old" %>>Âè§„ÅÑÈ†Ü</option>
        </select>
      </div>
    <% end %>
  </div>
</div>
