<%# Â≠£ÁØÄ„Åî„Å®„ÅÆÁµµÊñáÂ≠ó === %>
<% season_icon = { "spring" => "üå∏", "summer" => "üåª", "autumn" => "üçÅ", "winter" => "‚ùÑÔ∏è" }[@season] %>

<div class="calendar-container <%= @season %>" data-season="<%= @season %>">
  <!-- === Êúà„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ÔºàTurbo„ÅßÈÉ®ÂàÜÊõ¥Êñ∞Ôºâ === -->
  <div class="flex items-center justify-between mb-6">
    <%= link_to "‚Üê",
        mypage_path(
          year: @month == 1 ? @year - 1 : @year,
          month: @month == 1 ? 12 : @month - 1
        ),
        data: { turbo_frame: "calendar_frame" },
        class: "month-nav text-2xl font-bold text-gray-600 hover:text-gray-800 transition-colors duration-200"
    %>

    <h2 class="text-2xl font-bold text-gray-800">
      <%= "#{@year}Âπ¥ #{@month}Êúà #{season_icon}" %>
    </h2>

    <%= link_to "‚Üí",
        mypage_path(
          year: @month == 12 ? @year + 1 : @year,
          month: @month == 12 ? 1 : @month + 1
        ),
        data: { turbo_frame: "calendar_frame" },
        class: "month-nav text-2xl font-bold text-gray-600 hover:text-gray-800 transition-colors duration-200"
    %>
  </div>

  <!-- === ÊõúÊó•„Éò„ÉÉ„ÉÄ„Éº === -->
  <div class="grid grid-cols-7 gap-3 mb-3">
    <% ["Êó•","Êúà","ÁÅ´","Ê∞¥","Êú®","Èáë","Âúü"].each_with_index do |day, i| %>
      <div class="text-center text-sm font-bold
                  <%= i == 0 ? 'text-red-500' : i == 6 ? 'text-blue-500' : 'text-gray-600' %>">
        <%= day %>
      </div>
    <% end %>
  </div>

  <!-- === Êó•‰ªò„Éû„Çπ === -->
  <div class="grid grid-cols-7 gap-3">
    <% @first_day.wday.times { %><div></div><% } %>

    <% demo_posts = {
      1 => "üå± Êú™Êù•ÂÆ£Ë®ÄÔºö„ÇÑ„Çä„Åü„ÅÑ„Åì„Å®„Çí‰∏Ä„Å§Ë°åÂãï„Å´Áßª„Åô„ÄÇ",
      3 => "üíå ÊÑüË¨ùÔºöÂÆ∂Êóè„Å®ÈÅé„Åî„ÅôÁ©è„ÇÑ„Åã„Å™Êúù„Å´ÊÑüË¨ù„ÄÇ",
      5 => "üåà Êï¥ÁêÜÔºöÊÄùËÄÉ„ÇíÊï¥„Åà„Å¶„ÄÅÁÑ¶„Çâ„ÅöÈÄ≤„ÇÇ„ÅÜ„ÄÇ",
      10 => "üíå ÊÑüË¨ùÔºöÂøúÊè¥„Åó„Å¶„Åè„Çå„ÅüÂèãÈÅî„Å´„ÅÇ„Çä„Åå„Å®„ÅÜ„ÄÇ",
      14 => "üåà Êï¥ÁêÜÔºöËá™ÂàÜ„ÅÆ„Éö„Éº„Çπ„ÇíÂ∞äÈáç„Åô„Çã„ÄÇ",
      20 => "üíå ÊÑüË¨ùÔºö„Ç≥„Éº„Éí„Éº„ÅåÁæéÂë≥„Åó„ÅÑÊúù„Å´ÊÑüË¨ù„ÄÇ",
    } %>

    <% @dates.each do |date| %>
      <% post_content = demo_posts[date.day] %>
      <% classes = ["calendar-day", "border", "border-gray-300"] %>
      <% classes << "today" if date == Date.today %>

      <% if post_content.present? %>
        <% classes << "has-post" %>
        <div class="<%= classes.join(' ') %>">
          <%= date.day %>
          <div class="tooltip"><%= post_content %></div>
        </div>
      <% else %>
        <% classes << "no-post" %>
        <div class="<%= classes.join(' ') %>"><%= date.day %></div>
      <% end %>
    <% end %>
  </div>

  <!-- === Âá°‰æã === -->
  <div class="legend-box">
    <div class="legend-item">
      <div class="legend-color bg-gray-100 border border-gray-300"></div>
      <span>ÊäïÁ®ø„Å™„Åó</span>
    </div>
    <div class="legend-item">
      <div class="legend-color bg-gradient-to-br from-orange-400 to-pink-400"></div>
      <span>ÊäïÁ®ø„ÅÇ„Çä</span>
    </div>
    <div class="legend-item">
      <div class="legend-color border-2 border-orange-500
                  bg-gradient-to-br from-orange-400 to-pink-400"></div>
      <span>‰ªäÊó•</span>
    </div>
  </div>
</div>
